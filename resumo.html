<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Resumo ‚Äì RF DRIVER</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="core/global.js"></script>

<style>
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;
}

body{
  background:#000;
  color:#fff;
}

.container{
  padding:30px 20px 140px;
  max-width:420px;
  margin:0 auto;
}

.logo-wrapper{
  width:90px;
  height:90px;
  margin:0 auto 20px auto;
  border-radius:50%;
  background:#000;
  display:flex;
  align-items:center;
  justify-content:center;
  box-shadow:0 0 30px rgba(250,204,21,.35);
}

.logo-img{
  width:70%;
}

.header{
  text-align:center;
  margin-bottom:25px;
}

.header h1{
  font-size:1.4rem;
  font-weight:700;
}

.header span{
  font-size:.85rem;
  color:#a1a1aa;
}

.card{
  background:#111;
  border-radius:16px;
  padding:16px;
  border:1px solid #1c1c1c;
  margin-bottom:18px;
}

.section-title{
  font-size:.85rem;
  color:#a1a1aa;
  margin-bottom:10px;
}

.route span{
  display:block;
  margin-bottom:6px;
}

.details div{
  display:flex;
  justify-content:space-between;
  margin-bottom:6px;
  font-size:.9rem;
}

.total-box{
  background:#151515;
  border:1px solid #facc15;
  border-radius:18px;
  padding:20px;
  text-align:center;
  margin-bottom:20px;
}

.total{
  font-size:2.2rem;
  font-weight:800;
  color:#facc15;
}

select{
  width:100%;
  padding:14px;
  border-radius:14px;
  background:#111;
  color:#fff;
  border:1px solid #1c1c1c;
}

.cta-area{
  position:fixed;
  bottom:0;
  left:0;
  right:0;
  padding:20px;
  background:#000;
}

.cta-primary{
  width:100%;
  padding:18px;
  border:none;
  border-radius:14px;
  font-size:1.05rem;
  font-weight:700;
  background:#facc15;
  color:#000;
  cursor:pointer;
}

.cta-primary:active{
  transform:scale(.97);
}
</style>
</head>

<body>

<div class="container">

  <div class="logo-wrapper">
    <img src="./icons/logo-1024.png" class="logo-img">
  </div>

  <div class="header">
    <h1>Resumo da Viagem</h1>
    <span>Confirme as informa√ß√µes</span>
  </div>

  <!-- ROTA -->
  <div class="card route">
    <div class="section-title">Itiner√°rio</div>
    <span>üìå Origem: <strong id="origemTxt"></strong></span>
    <span>üèÅ Destino: <strong id="destinoTxt"></strong></span>
  </div>

  <!-- DETALHAMENTO -->
  <div class="card">
    <div class="section-title">Detalhamento</div>
    <div class="details" id="detalhamento"></div>
  </div>

  <!-- OBSERVA√á√ÉO -->
  <div class="card" id="blocoObservacao" style="display:none;">
    <div class="section-title">Observa√ß√£o</div>
    <div id="observacaoTxt"></div>
  </div>

  <!-- PAGAMENTO -->
  <div class="card">
    <div class="section-title">Forma de Pagamento</div>
    <select id="formaPagamento">
      <option value="Dinheiro">Dinheiro</option>
      <option value="Pix">Pix</option>
      <option value="Cart√£o">Cart√£o</option>
    </select>
  </div>

  <!-- TOTAL -->
  <div class="total-box">
    <div class="total" id="total">R$ 0,00</div>
  </div>

</div>

<div class="cta-area">
  <button class="cta-primary" onclick="solicitar()">
    Solicitar Viagem
  </button>
</div>

<script>

const origem = App.get("origem");
const destino = App.get("destino");
const valorBase = Number(App.get("valorBase") || 0);
const config = App.get("taxasConfig") || {};

document.getElementById("origemTxt").innerText = origem || "-";
document.getElementById("destinoTxt").innerText = destino || "-";

if(config.observacao){
  document.getElementById("blocoObservacao").style.display = "block";
  document.getElementById("observacaoTxt").innerText = config.observacao;
}

let total = valorBase;
let detalhes = [];

// üîπ Categoria
const multiplicador = Number(config.multiplicador || 1);
const categoria = config.categoria || "hatch";

const valorCategoria = valorBase * multiplicador;

detalhes.push(["Categoria", categoria.toUpperCase()]);
detalhes.push(["Valor base", valorBase]);
if(multiplicador !== 1){
  detalhes.push(["Multiplicador aplicado", `x${multiplicador}`]);
}

total = valorCategoria;

// üî• ADICIONAL NOTURNO
if(config.taxaNoturna){
  let acres = 0;

  if(valorCategoria <= 29){
    acres = 5;
    detalhes.push(["Adicional noturno", 5]);
  }else{
    acres = valorCategoria * 0.35;
    detalhes.push(["Adicional noturno (35%)", acres]);
  }

  total += acres;
}

document.getElementById("detalhamento").innerHTML =
detalhes.map(d=>`
  <div>
    <span>${d[0]}</span>
    <strong>
      ${
        typeof d[1] === "number"
        ? "R$ " + Number(d[1]).toFixed(2)
        : d[1]
      }
    </strong>
  </div>
`).join("");

document.getElementById("total").innerText =
`R$ ${total.toFixed(2)}`;

App.set("total", total);

function solicitar(){
  const pagamento = document.getElementById("formaPagamento").value;
  App.set("formaPagamento", pagamento);
  App.go("procurando.html");
}

</script>

</body>
</html>